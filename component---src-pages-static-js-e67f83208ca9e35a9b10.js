(self.webpackChunkmask_map=self.webpackChunkmask_map||[]).push([[103],{4796:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return O}});var r=n(7294),o=n(6179),a=n(9610),i=n(3875),l=n(5144),s=n(9925),u=n(5444),c=n(5254),p=(0,r.createContext)(),d=function(e){var t=e.children,n=(0,u.useStaticQuery)("2734007671").allMaskdataJson,o=(0,r.useContext)(c.h).filter,a=n.nodes[0],i=(0,r.useState)([]),l=i[0],s=i[1];return!o.all&&l.length>0&&(l=o.adult?l.filter((function(e){return e.properties.mask_adult>0})):l.filter((function(e){return e.properties.mask_child>0}))),r.createElement(p.Provider,{value:{store:l,setStore:s,geoJson:a}},t)},f=n(8320),m=n(2929),g=n(7382),h=n(4118),x=n.n(h),b=n(8437),w=n(2443),E=function(){var e=(0,f.Wf)().map;window.map=e;var t,n=(0,u.useStaticQuery)("1273601004").allFile.nodes,o=(0,b.m)(n),a=o.shadow,i=o.orange,l=o.red,s=o.green,c=(0,r.useContext)(p).geoJson;return r.createElement(g.Z,{disableClusteringAtZoom:17},r.createElement(m.Z,{key:"geoJson",data:c,pointToLayer:function(e,n){var r=e.properties,o=r.mask_adult+r.mask_child;return t=o>=100?i:l,0===o&&(t=s),x().marker(n,{icon:(0,b.I)({iconUrl:t,shadowUrl:a})})},onEachFeature:function(e,t){t.bindPopup((0,w.g)(e.properties))}}))},k={lat:25.045655,lng:121.536456},v=function(){var e=(0,r.useContext)(p),t=e.setStore,n=e.geoJson,o=(0,r.useRef)(),l=function(e){var r=e._southWest,o=e._northEast,a=function(e,t,n){return e.features.filter((function(e){var r=e.geometry.coordinates,o=r[0],a=r[1];return a>t.lat&&o>t.lng&&a<n.lat&&o<n.lng}))}(n,r,o);t(a)},s=function(e){l(e.target.getBounds())};return(0,r.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(e){var t=e.coords,n=t.latitude,r=t.longitude;o.current.leafletElement.flyTo(new(x().LatLng)(n,r))}))}),[]),(0,r.useEffect)((function(){l(o.current.leafletElement.getBounds())}),[]),(0,r.useMemo)((function(){return r.createElement(Z,{zoom:16,zoomControl:!1,maxZoom:18,minZoom:10,center:k,onmoveend:s,ref:o},r.createElement(a.Z,{position:"topright"}),r.createElement(i.Z,{attribution:'Map data <a href="http://osm.org/copyright">OpenStreetMap</a> contributors Sam',url:"https://wmts.nlsc.gov.tw/wmts/EMAP/default/EPSG:3857/{z}/{y}/{x}"}),r.createElement(E,null))}),[])},Z=(0,s.ZP)(l.Z).withConfig({displayName:"map__Container",componentId:"sc-19m25xi-0"})(["height:100vh;z-index:0;transition:width 0.5s;"]),C=n(8001),_=n(9818),y=n(1977),S=n(8657),P=function(){var e=(0,r.useContext)(p).store,t=(0,r.useContext)(y.s).text,n=(0,r.useState)(9),o=n[0],a=n[1],i=[];e.forEach((function(e){if(!function(e){var n=e.properties,r=n.name,o=n.address;return-1===r.indexOf(t)&&-1===o.indexOf(t)}(e)){var n=e.geometry.coordinates,o=n[0],a=n[1];i.push(r.createElement(S.Z,{properties:e.properties,coordinates:[a,o],key:e.properties.id}))}}));var l=o+1<i.length?r.createElement(M,{onClick:function(){e.length>10&&a((function(e){return e+10}))}},"載入更多"):null;return r.createElement(z,null,i.slice(0,o),l)},z=s.ZP.div.withConfig({displayName:"list__Container",componentId:"sc-1xwlx2s-0"})(["width:100%;height:calc(100vh - 136px - 124px);background:#ffffff 0% 0% no-repeat padding-box;overflow:auto;&::-webkit-scrollbar-thumb{border-radius:10px;-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,0.3);background-color:#cccccc;}&::-webkit-scrollbar{width:8px;height:8px;background-color:#f5f5f5;}&::-webkit-scrollbar-track{-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,0.3);border-radius:10px;background-color:#fff;}"]),M=s.ZP.div.withConfig({displayName:"list__Button",componentId:"sc-1xwlx2s-1"})(["width:100px;height:50px;margin:auto;line-height:50px;text-align:center;cursor:pointer;"]),I=n(6831),J=function(){var e=(0,r.useState)(!0),t=e[0],n=e[1];return r.createElement(s.f6,{theme:{toggle:t}},r.createElement(N,null,r.createElement(C.Z,null),r.createElement(y.Z,null,r.createElement(_.Z,null),r.createElement(P,null)),r.createElement(I.Z,{setToggle:n})))},N=s.ZP.div.withConfig({displayName:"sidebar__Container",componentId:"nrjp9e-0"})(["@media (min-width:360px){height:100%;width:315px;-webkit-box-shadow:5px 0px 15px -8px rgba(0,0,0,0.77);-moz-box-shadow:5px 0px 15px -8px rgba(0,0,0,0.77);box-shadow:5px 0px 15px -8px rgba(0,0,0,0.77);z-index:1;background:#ffffff 0% 0% no-repeat padding-box;display:grid;grid-template-rows:136px 124px auto;transform:",";position:fixed;transition:transform 0.5s;}@media (min-width:768px){position:relative;transform:translateX(0);}"],(function(e){return e.theme.toggle?"translateX(-100%)":"translateX(0)"})),B=function(e){var t=e.children;return r.createElement(c.Z,null,r.createElement(d,null,t))},L=n(8564),O=function(){return r.createElement(L.Z,null,r.createElement(B,null,r.createElement(o.Z,{title:"Mask map"}),r.createElement(J,null),r.createElement(v,null)))}}}]);
//# sourceMappingURL=component---src-pages-static-js-e67f83208ca9e35a9b10.js.map